<?php

/**
 * PeeringManagerTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PeeringManagerTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object PeeringManagerTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('PeeringManager');
    }

    /**
     * Load (or create with defaults) a peering manager entry for the
     * given customer and peer id.
     *
     * @param int $cid The customer ID
     * @param int $pid The peer ID
     * @return PeeringManager The peering manager object
     */
    public static function getEntry( $cid, $pid )
    {
        $pm = Doctrine_Query::create()
            ->from( 'PeeringManager pm' )
            ->where( 'pm.custid = ?', $cid )
            ->andWhere( 'pm.peerid = ?', $pid )
            ->fetchOne( null, Doctrine_Core::HYDRATE_RECORD );
        
        if( !$pm )
        {
            $pm = new Peeringmanager();
            $pm['custid']          = $cid;
            $pm['peerid']          = $pid;
            $pm['email_last_sent'] = null;
            $pm['emails_sent']     = 0;
            $pm['peered']          = 0;
            $pm['rejected']        = 0;
            $pm['notes']           = '';
            $pm['created']         = date( 'Y-m-d H:i:s' );
            $pm['updated']         = date( 'Y-m-d H:i:s' );
        }
        
        return $pm;
    }
    
}